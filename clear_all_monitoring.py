import db_mongo

# –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ MongoDB
db_mongo.init_mongodb()

print("=" * 80)
print("üóëÔ∏è  –û–ß–ò–©–ï–ù–ù–Ø –î–ê–ù–ò–• –ú–û–ù–Ü–¢–û–†–ò–ù–ì–£")
print("=" * 80)

# –ü–æ–∫–∞–∑–∞—Ç–∏ —â–æ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ
monitoring_count = db_mongo.db['monitoring_data'].count_documents({})
print(f"\nüìä –ó–Ω–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å—ñ–≤ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É: {monitoring_count}")

if monitoring_count > 0:
    # –ü–æ–∫–∞–∑–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ
    records = list(db_mongo.db['monitoring_data'].find({}, {'year': 1, 'class': 1, 'teacher': 1, 'subject': 1}))
    print("\nüìù –ë—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ:")
    for idx, record in enumerate(records, 1):
        print(f"   {idx}. {record.get('year')} - {record.get('class')} - {record.get('subject')} ({record.get('teacher')})")
    
    # –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
    print("\n‚ö†Ô∏è  –£–í–ê–ì–ê: –¶–µ –≤–∏–¥–∞–ª–∏—Ç—å –í–°–Ü –¥–∞–Ω—ñ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É!")
    print("   –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —à–∫–æ–ª–∏ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω.")
    confirm = input("\n‚ùì –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ? –í–≤–µ–¥—ñ—Ç—å '–¢–ê–ö' –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è: ")
    
    if confirm.upper() == '–¢–ê–ö':
        # –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
        result = db_mongo.db['monitoring_data'].delete_many({})
        print(f"\n‚úÖ –£—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ {result.deleted_count} –∑–∞–ø–∏—Å—ñ–≤!")
        print("üìä –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –≥–æ—Ç–æ–≤–∞ –¥–æ —Ä–æ–±–æ—Ç–∏ –∑ —á–∏—Å—Ç–∏–º–∏ –¥–∞–Ω–∏–º–∏")
    else:
        print("\n‚ùå –û–ø–µ—Ä–∞—Ü—ñ—é —Å–∫–∞—Å–æ–≤–∞–Ω–æ")
else:
    print("\n‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –≤–∂–µ –ø–æ—Ä–æ–∂–Ω—è - –Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è")

print("\n" + "=" * 80)